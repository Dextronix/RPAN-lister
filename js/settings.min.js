var barn=new Barn(localStorage);checkdarkmode();var trashStack=[],activeStack={selectedtmp:[],activeList:0,list:"0"};function checkdarkmode(){$("html").toggleClass("darkmode",barn.get("setting_darkmode")||!1)}function goBack(){window.location.href="/RPAN-lister"}$(".trashcontrols a").on("click",function(){var a=$(this).index();0<trashStack.length&&(0==a?doRestore():1==a&&deletetrash())}),$(document).ready(function(){$(".addbutton").on("click",function(){var a=$(".namebox").val();a.match(/^[0-9a-zA-Z-_]{3,21}$/)?(barn.sadd(getlistStr(activeStack.activeList),a.toLowerCase()),populateList(getList(activeStack.activeList))):21<a.length?alert("Reddit user/sub names have a 21 character limit"):($(".namebox").val(""),alert("Invalid user/sub name"))}),registerSettings(),registerSlider(),populateList(getList(0))}),$(document).bind("mousedown",function(a){0<!$(a.target).parents(".custom-menu2").length&&$(".custom-menu2").hide(100)}),$(".tabhead").on("click",function(){$(".custom-menu2").hide(),activeStack.selectedtmp=[];var a=$(this).index();$(".tabhead").removeClass("active"),$(this).addClass("active"),0==a?(activeStack.activeList=0,populateList(getList(0))):1==a?(activeStack.activeList=1,populateList(getList(1))):2==a?(activeStack.activeList=2,populateList(getList(2))):3==a&&(activeStack.state="trash",activeStack.activeList=3,populateTrash())});function getList(a){if(0==a)return barn.smembers("highlitUsers")||[];return 1==a?barn.smembers("hiddenUsers")||[]:2==a?barn.smembers("hiddenSubs")||[]:3==a?JSON.parse(barn.get("setting_trash")):void 0}function manageBarn(a,b){var c=barn.smembers(a);if(c=_.compact(c),b=_.compact(b),c.length>b.length){var d=_.difference(c,b);$.each(d,function(b,c){barn.srem(a,c)})}else if(c.length<b.length){var d=_.difference(b,c);$.each(d,function(b,c){barn.sadd(a,c)})}barn.condense()}function setList(a,b){0==a?manageBarn("highlitUsers",b):1==a?manageBarn("hiddenUsers",b):2==a?manageBarn("hiddenSubs",b):3==a&&barn.set("setting_trash",JSON.stringify(b))}function getlistStr(a){if(0==a)return"highlitUsers";return 1==a?"hiddenUsers":2==a?"hiddenSubs":void 0}function getMove(){return 0==activeStack.activeList?1:1==activeStack.activeList?0:-1}$(".controls a").on("click",function(){var a=$(this).index();if(!(0==a))1==a?_.isEmpty(activeStack.selectedtmp)||deleteMenu():2==a&&($(".boxcontainer").toggle(),$(".namebox").val(""));else if(!_.isEmpty(activeStack.selectedtmp)){var b=getMove();1==b?moveMenu("Hidden Users"):0==b?moveMenu("Highlit Users"):moveMenu()}});function doRestore(){$.each(trashStack,function(a,b){barn.sadd(getlistStr(b.list),b.name)}),deletetrash()}function doMove(a){var b=_.concat(getList(a),activeStack.selectedtmp);setList(a,b)}function populateList(a){$(".boxcontainer").hide(),$(".namebox").val(""),$(".controls").show(),$(".trashcontrols").hide(),$(".listcontent").empty(),$.each(a,function(a,b){$(".listcontent").append($("<input type=\"checkbox\" class=\"chkbox\" value=\""+b+"\" name=\""+b+"\"><label for=\""+b+"\">"+b+"</label><br>"))}),$(".chkbox").on("click",function(){activeStack.selectedtmp=[],$("input[class='chkbox']:checked").each(function(){activeStack.selectedtmp.push($(this).attr("name"))})})}function doDelete(a=!0){var b=_.difference(getList(activeStack.activeList),activeStack.selectedtmp);setList(activeStack.activeList,b),a&&itemizeTrash()}function itemizeTrash(){var a,b=[];for(a=0;a<activeStack.selectedtmp.length;a++)b.push({name:activeStack.selectedtmp[a],list:activeStack.activeList});trash=getList(3),trash=_.uniq(_.concat(b,trash),_.isEqual),setList(3,trash)}function populateTrash(){$(".controls").hide(),$(".trashcontrols").show(),$(".listcontent").empty(),TR=_.compact(getList(3));$.each(TR,function(a,b){var c=`<input type="checkbox" class="chkbox" data-list="${b.list}" data-name="${b.name}"><label for="${b.name}">${b.name}</label><br>`;$(".listcontent").append($(c))}),$(".chkbox").on("click",function(){trashStack=[],$("input[class='chkbox']:checked").each(function(){trashStack.push({name:$(this).attr("data-name"),list:_.toSafeInteger($(this).attr("data-list"))})})})}function deletetrash(){var a=_.differenceWith(getList(3),trashStack,_.isEqual);setList(activeStack.activeList,a),populateTrash()}function moveMenu(a){a?$(".custom-menu2").html("<li data-action=\"move\">"+a+"</li><li data-action=\"trash\">Trash</li>"):$(".custom-menu2").html("<li data-action=\"trash\">Trash</li>");var b=$(".controls a").first(),c=b.position();$(".custom-menu2").finish().toggle(100).css({top:c.top+5+"px",left:c.left-10+"px"}),registerMenu()}function deleteMenu(){$(".custom-menu2").html("<li data-action=\"supertrash\">Forever</li><li data-action=\"trash\">To Trash</li>");var a=$(".controls a").first(),b=a.position();$(".custom-menu2").finish().toggle(100).css({top:b.top+5+"px",left:b.left+50+"px"}),registerMenu()}function registerMenu(){$(".custom-menu2 li").on("click",function(){var a=$(this).attr("data-action");"move"==a?(doMove(getMove()),doDelete(!1),populateList(getList(activeStack.activeList))):"trash"==a?(doDelete(!0),populateList(getList(activeStack.activeList))):"supertrash"==a&&(doDelete(!1),populateList(getList(activeStack.activeList))),$(".custom-menu2").hide(100)})}function registerSettings(){var a=barn.get("setting_darkmode")||!1,b=barn.get("setting_refresh")||!1;$("[data-action=darkmode]").prop("checked",a),$("[data-action=autorefresh]").prop("checked",b),$("input[class='setting']").on("change",function(){var c=$(this).attr("data-action");"darkmode"==c?(a=!a,barn.set("setting_darkmode",a),checkdarkmode()):"autorefresh"==c&&(b=!b,barn.set("setting_refresh",b),registerSlider(),!b&&barn.set("setting_interval",10)),$(".container").toggle(b)}),$(".container").toggle(b),barn.condense()}function registerSlider(){var a=barn.get("setting_interval")||10;$(".range-slider").empty(),$(".range-slider").append(`<input class="range-slider__range" type="range" value="${a}" min="5" max="60"><span class="range-slider__value">0</span>`);var b=$(".range-slider"),c=$(".range-slider__range"),d=$(".range-slider__value");b.each(function(){d.each(function(){$(this).prev().attr("value");$(this).html(a+" s")}),c.on("input",function(){$(this).next(d).html(this.value+" s")}),c.on("mouseup touchend",function(){barn.set("setting_interval",this.value)})})}